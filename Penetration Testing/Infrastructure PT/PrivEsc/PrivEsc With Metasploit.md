**Using BuildIn Recon Tool with Metasploit**
this tool will make Recon on the machine that you gain foothold on and suggest you the modules that might be match with the vulnerabilities of the machine 
```
use post/multi/recon/local_exploit_suggester
```

* in Win Environment with meterpreter you might use an exploit to PriveEs 
	but after running the xploit it didn't elevate you, so you need to run getsystem command on meterpreter .

**Non Patched OS**(Windows Env)
After gaining foothold on remote host, we can enumerate it with Metasploit to see witch patched are installed on the host to search NonInstalled Patches in order to use this vulnerability and epxloit it to Escalate. 

use
```
post/windows/gather/enum_patches
```
* in options choose Ur KB patches. (you can still do it in new version without seeing the KB's in options , because in the new vers they set a txt file of KB's that's run automatically)

*  *Privilege Escalation Table*
Common PrivSec xploits with their KB to search in Metasploit

|                                                                              |                             |                       |         |                                                                                                                                                                                                                                                                                                                     |
| ---------------------------------------------------------------------------- | --------------------------- | --------------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Operating System**                                                         | **Description**             | **Security Bulletin** | **KB**  | **Exploit**                                                                                                                                                                                                                                                                                                         |
| Windows Server 2016                                                          | Windows Kernel Mode Drivers | MS16-135              | 3199135 | [Exploit](https://github.com/mwrlabs/CVE-2016-7255)<br><br>[Github](https://github.com/FuzzySecurity/PSKernel-Primitives/blob/master/Sample-Exploits/MS16-135/MS16-135.ps1)                                                                                                                                         |
| Windows Server 2008 ,7,8,10 Windows Server 2012                              | Secondary Logon Handle      | MS16-032              | 3143141 | [Github](https://github.com/khr0x40sh/ms16-032)<br><br>[exploitDB](https://www.exploit-db.com/exploits/39719/)<br><br>[Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms16_032_secondary_logon_handle_privesc)                                                                                 |
| Windows Server 2008, Vista, 7                                                | WebDAV                      | MS16-016              | 3136041 | [Github](https://github.com/koczkatamas/CVE-2016-0051)                                                                                                                                                                                                                                                              |
| Windows Server 2003, Windows Server 2008, Windows 7, Windows 8, Windows 2012 | Windows Kernel Mode Drivers | MS15-051              | 3057191 | [Github](https://github.com/hfiref0x/CVE-2015-1701/raw/master/Compiled/Taihou32.exe)<br><br>[ExploitDB](https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/37049-32.exe)<br><br>[Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms15_051_client_copy_image) |
| Windows Server 2003, Windows Server 2008, Windows Server 2012, 7, 8          | Win32k.sys                  | MS14-058              | 3000061 | [Github](https://github.com/sam-b/CVE-2014-4113)<br><br>[ExploitDB](https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/39666.zip)<br><br>[Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms14_058_track_popup_menu)                                         |
| Windows Server 2003, Windows Server 2008, 7, 8, Windows Server 2012          | AFD Driver                  | MS14-040              | 2975684 | [ExploitDB](https://www.exploit-db.com/exploits/39446/)<br><br>[Github](https://github.com/JeremyFetiveau/Exploits/blob/master/MS14-040.cpp)                                                                                                                                                                        |
| Windows Server 2003, Windows Server 2008, 7, 8, Windows Server 2012          | Kernel Mode Driver          | MS13-005              | 2778930 | [Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms13_005_hwnd_broadcast)<br><br>[ExploitDB](https://www.exploit-db.com/exploits/24485/)<br><br>[Github](https://github.com/0vercl0k/stuffz/blob/master/ms13-005-funz-poc.cpp)                                                                  |
| Windows Server 2008, 7                                                       | Task Scheduler              | MS10-092              | 2305420 | [Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms10_092_schelevator)<br><br>[ExploitDB](https://www.exploit-db.com/exploits/15589/)                                                                                                                                                           |
| Windows Server 2003, Windows Server 2008, 7, XP                              | KiTrap0D                    | MS10-015              | 977165  | [ExploitDB](https://www.exploit-db.com/exploits/11199/)<br><br>[Github](https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/11199.zip)<br><br>[Metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms10_015_kitrap0d)                                             |
| Windows Server 2003, Windows Server 2008, 7, 8, Windows Server 2012          | Kernel Driver               | MS15-061              | 3057839 | [Github](https://github.com/Rootkitsmm/MS15-061)                                                                                                                                                                                                                                                                    |
* search your Vuln Results in Metasploit for searching xploit to run or github ot exploitdb 
* run the xploit and get Escalated* 